<html>

<head>
    <meta charset="UTF-8">
    <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', app);
        function app() {
            const canvas = document.querySelector('canvas');
            const W = canvas.width, H = canvas.height;
            const context = canvas.getContext('2d');
            // console.log(context)

            //1. Model

            let x = 250, y = 200, w = 70, h = 70, vy = -1.5;
            //pozitia mouse ului
            let mx = 0, my = 0;

            //2.desenare
            function desenare() {
                //a). stergere canvas

                context.fillStyle = 'silver';
                context.fillRect(0, 0, W, H);

                //b). desenare pe baza modelului
                context.fillStyle = 'red';
                context.fillRect(x, y, w, h);


                context.fillText(`mx=${mx} my=${my}`, 10, 10);

                requestAnimationFrame(desenare);
            }
            desenare();

            function actualizare() {
                y = y + vy;

                if (y < 0) {
                    y = 0;
                    vy = Math.abs(vy);
                } else if (y + h > H) {
                    y = H - h;
                    vy = -Math.abs(vy);
                }
            }
            setInterval(actualizare, 10);


            //4. evenimente
            canvas.addEventListener('mousemove', e => {
                mx = Math.round(e.clientX - canvas.getBoundingClientRect().left);
                my = Math.round(e.clientY - canvas.getBoundingClientRect().top);
            });

            canvas.addEventListener('click', e => {
                x = mx;
                y = my;
            })
        }
    </script>
</head>

<body>
    <canvas width="800" height="600">

    </canvas>
</body>

</html>